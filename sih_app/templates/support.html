<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Support Hub | Chat & Booking</title>
  <style>
    :root{--bg:#f7fbff;--card:#fff;--ink:#12223a;--muted:#58708d;--primary:#6c7bff;--p2:#9b8cff;--shadow:0 10px 30px rgba(18,34,58,.08);--radius:14px}
    html,body{margin:0;color:var(--ink);font:16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial}
    body{background:linear-gradient(180deg,#f6f8ff,#fefbff)}
    a{color:inherit;text-decoration:none}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}
    header{position:sticky;top:0;z-index:10;background:rgba(255,255,255,.7);backdrop-filter: blur(10px);border-bottom:1px solid #eef2ff}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800}
    .logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--primary),var(--p2));box-shadow:var(--shadow)}
    nav ul{display:flex;gap:14px;list-style:none;margin:0;padding:0}
    nav a{padding:8px 12px;border-radius:10px;color:var(--muted)}
    nav a:hover, nav a.active{background:#eef2ff;color:var(--ink)}

    .grid{display:grid;grid-template-columns:1fr 1fr;gap:22px;margin:24px 0}
    .card{background:var(--card);border:1px solid #eef2ff;border-radius:var(--radius);box-shadow:var(--shadow)}

    .chat{display:grid;grid-template-rows:auto 1fr auto;min-height:520px}
    .chat header{position:relative;background:#fff;border-bottom:1px solid #eef2ff;border-radius:14px 14px 0 0}
    .chat h2{margin:0;padding:16px 18px}
    .messages{padding:16px;overflow:auto;display:flex;flex-direction:column;gap:10px}
    .msg{max-width:80%;padding:10px 12px;border-radius:12px}
    .bot{align-self:flex-start;background:#eef2ff;color:#111827}
    .user{align-self:flex-end;background:linear-gradient(135deg,var(--primary),var(--p2));color:#fff}
    .composer{display:flex;gap:10px;padding:12px;border-top:1px solid #eef2ff}
    input[type=text]{flex:1;padding:12px;border-radius:10px;border:1px solid #e5e7eb}
    .btn{background:linear-gradient(135deg,var(--primary),var(--p2));color:#fff;border:none;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}

    form.booking{display:grid;gap:12px;padding:18px}
    .row{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    label{font-weight:600}
    select, input[type=date], input[type=time]{width:100%;padding:12px;border-radius:10px;border:1px solid #e5e7eb}

    @media(max-width: 900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
  <div class="brand"><div class="logo"></div><span>Soulence</span></div>
      <nav aria-label="Primary">
        <ul>
          <li><a href="/">Home</a></li>
    <li><a class="active" href="/support/">Support Hub</a></li>
          <li><a href="/book-slot/">Book Appointment</a></li>
    <li><a href="/wellness/">Wellness Hub</a></li>
    <li><a href="/peer/">Peer Support</a></li>
    <li><a href="/myspace/">My Space</a></li>
    <li><a href="/logout/" style="color:#fff;background:linear-gradient(135deg,#6c7bff,#9b8cff);padding:8px 14px;">Logout</a></li>
        </ul>
      </nav>
    </div>
  </header>


  <main class="container">
    <section class="card chat" id="chat" style="max-width: 700px; margin: 40px auto;">
      <header><h2>AI Chat</h2></header>
      <div id="messages" class="messages" aria-live="polite"></div>
      <style>
        .loading-bubble {
          display: inline-flex;
          align-items: center;
          gap: 4px;
          padding: 10px 16px;
          background: #eef2ff;
          color: #111827;
          border-radius: 12px;
          margin: 4px 0 0 0;
          min-width: 48px;
        }
        .loading-bubble span {
          display: inline-block;
          width: 8px;
          height: 8px;
          background: #6c7bff;
          border-radius: 50%;
          animation: bounce 1s infinite alternate;
        }
        .loading-bubble span:nth-child(2) { animation-delay: 0.2s; }
        .loading-bubble span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes bounce {
          0% { transform: translateY(0); opacity: 0.7; }
          100% { transform: translateY(-8px); opacity: 1; }
        }
      </style>
      <div class="composer">
        <input id="chatInput" type="text" placeholder="Ask anything..." />
        <button id="sendBtn" class="btn">Send</button>
      </div>
    </section>
  </main>

  <script>
    const messages = document.getElementById('messages');
    const input = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendBtn');

    const BOT = {
      hello: "Hi! I'm here to listen. How are you feeling today?",
      anxiety: "Anxiety can be overwhelming. Try a 4-7-8 breath: inhale 4, hold 7, exhale 8. Would you like a quick guide?",
      exam: "Exam stress is common. Let's plan: list topics, schedule short blocks, add breaks. You've got this!",
      stress: "Noticing stress is a great first step. What helps you unwind? A short walk, music, or a 5‑minute stretch can help.",
      depressed: "I'm sorry you're going through this. You're not alone. Consider talking to a counsellor—booking is on the right.",
      default: "I may not understand perfectly, but I'm here for you. You can try rephrasing or ask about anxiety, exams, or stress."
    };

    function addMsg(text, who){
      const div = document.createElement('div');
      div.className = `msg ${who}`;
      div.textContent = text;
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }

    // Add and remove loading animation
    let loadingDiv = null;
    function showLoading() {
      if (loadingDiv) return;
      loadingDiv = document.createElement('div');
      loadingDiv.className = 'msg bot';
      loadingDiv.setAttribute('id', 'loading-bubble');
      loadingDiv.innerHTML = `<div class="loading-bubble" aria-label="AI is typing">
        <span></span><span></span><span></span>
      </div>`;
      messages.appendChild(loadingDiv);
      messages.scrollTop = messages.scrollHeight;
    }
    function hideLoading() {
      if (loadingDiv) {
        loadingDiv.remove();
        loadingDiv = null;
      }
    }

    // Replace with your n8n chatbot API endpoint
    const N8N_API_URL = 'https://jaideep2404.app.n8n.cloud/webhook/33fb3d28-1c39-4ccf-b4c5-04b45a09cf33';

    async function send(){
      const v = input.value.trim();
      if(!v) return;
      addMsg(v,'user');
      input.value = '';
      showLoading();
      try {
        const res = await fetch(N8N_API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ message: v })
        });
        const data = await res.json();
        hideLoading();
        addMsg(data.output || 'Sorry, no response from chatbot.','bot');
      } catch (err) {
        hideLoading();
        addMsg('Error contacting chatbot API.','bot');
      }
    }

    sendBtn.addEventListener('click', send);
    input.addEventListener('keydown', e=>{ if(e.key==='Enter'){ e.preventDefault(); send(); }});

    addMsg('Hi! I\'m here to listen. How are you feeling today?','bot');

    // Booking form removed
  </script>
</body>
</html>

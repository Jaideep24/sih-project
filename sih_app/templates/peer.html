<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Peer Support | Chat Rooms</title>
  <style>
    :root{
      --bg: #f6f8ff;
      --bg-2: #fdf7ff;
      --card: #ffffff;
      --ink: #1f2a44;
      --muted: #5b6b8c;
      --primary: #6c7bff;
      --primary-2:#9b8cff;
      --accent: #9be7d6;
      --danger: #ff6b6b;
      --shadow: 0 10px 30px rgba(31,42,68,0.08);
      --radius: 14px;
      --ring: 0 0 0 3px rgba(108,123,255,0.25);
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;color:var(--ink);font:16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"}
    body{background: linear-gradient(180deg,var(--bg), var(--bg-2));}
    a{color:inherit;text-decoration:none}
    .container{max-width:1100px;margin:0 auto;padding:0 20px}
    header{position:sticky;top:0;z-index:10;background:rgba(255,255,255,.7);backdrop-filter: blur(10px);border-bottom:1px solid #eef2ff}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;letter-spacing:.3px}
    .logo{width:38px;height:38px;border-radius:10px;background: linear-gradient(135deg,var(--primary),var(--primary-2));box-shadow: var(--shadow)}
  .logo{width:38px;height:38px;border-radius:5px;background: url('https://i.ibb.co/cc08mZ9Q/Soulence-logo.jpg') center/cover no-repeat, linear-gradient(135deg,var(--primary),var(--primary-2));box-shadow: var(--shadow)}
    nav ul{display:flex;flex-wrap:wrap;gap:14px;list-style:none;padding:0;margin:0}
    nav a{padding:8px 12px;border-radius:10px;color:var(--muted)}
    nav a:hover, nav a.active{background:#eef2ff;color:var(--ink)}

    .card{background:var(--card);border:1px solid #eef2ff;border-radius:var(--radius);box-shadow:var(--shadow)}
    .content{padding:40px 0}
    h1{font-size:clamp(28px,4vw,36px);line-height:1.2;margin:0 0 8px;text-align:center}
    .subtitle{color:var(--muted);margin:0 0 32px;text-align:center}

    .create-form{padding:24px;margin-bottom:32px}
    .form-group{margin-bottom:16px}
    label{display:block;margin-bottom:6px;font-weight:600;color:var(--ink)}
    input, select{width:100%;padding:12px 16px;border:1px solid #e5e7eb;border-radius:10px;font-size:14px}
    input:focus, select:focus{outline:none;border-color:var(--primary);box-shadow:var(--ring)}
    .btn{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(135deg,var(--primary),var(--primary-2));color:#fff;padding:12px 18px;border:none;border-radius:12px;font-weight:600;box-shadow: var(--shadow);cursor:pointer;font-size:14px}
    .btn:hover{transform:translateY(-1px);box-shadow:0 15px 35px rgba(31,42,68,0.12)}
    .btn:focus{outline:none;box-shadow: var(--shadow), var(--ring)}

    .rooms-grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:40px}
    @media(max-width: 768px){.rooms-grid{grid-template-columns:1fr}}
    
    .room-section h2{font-size:20px;margin:0 0 16px;color:var(--ink)}
    .room-list{padding:20px}
    .room-item{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f1f5f9}
    .room-item:last-child{border-bottom:none}
    .room-info{flex:1}
    .room-name{font-weight:600;color:var(--ink);margin:0 0 4px}
    .room-category{font-size:13px;color:var(--muted)}
    .btn-join{background:linear-gradient(135deg,#22c55e,#16a34a);padding:8px 16px;font-size:13px;margin-left:12px}
    .btn-view{background:linear-gradient(135deg,#f59e0b,#d97706);padding:8px 16px;font-size:13px;margin-left:12px;position:relative}
    .btn-view:hover{background:linear-gradient(135deg,#fbbf24,#f59e0b);transform:translateY(-1px)}
    .btn-view::before{content:'ðŸ“š';margin-right:6px}
    .empty-state{text-align:center;padding:32px;color:var(--muted)}

    .alert{padding:12px 16px;border-radius:10px;margin-bottom:16px}
    .alert-danger{background:#fef2f2;border:1px solid #fecaca;color:#dc2626}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand"><div class="logo" aria-hidden="true"></div><span>Soulence</span></div>
      <nav aria-label="Primary">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/support/">Support Hub</a></li>
          <li><a href="/book-slot/">Book Appointment</a></li>
          <li><a href="/wellness/">Wellness Hub</a></li>
          <li><a href="/peer/" class="active">Peer Support</a></li>
          <li><a href="/myspace/">My Space</a></li>
          <li><a href="/logout/" style="color:#fff;background:linear-gradient(135deg,#6c7bff,#9b8cff);padding:8px 14px;">Logout</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="container content">
    <h1>Peer Support Chat Rooms</h1>
    <p class="subtitle">Connect with fellow students in a safe, supportive environment</p>

    <div class="card create-form">
      <h2 style="margin:0 0 20px;font-size:18px">Create New Chat Room</h2>
      {% if form_errors %}
        <div class="alert alert-danger">
          {% for field, errors in form_errors.items %}
            {% for error in errors %}
              <div>{{ error }}</div>
            {% endfor %}
          {% endfor %}
        </div>
      {% endif %}
      <form method="post">
        {% csrf_token %}
        <div class="form-group">
          <label for="id_name">Room Name</label>
          {{ form.name }}
        </div>
        <div class="form-group">
          <label for="id_category">Category</label>
          {{ form.category }}
        </div>
        <button type="submit" class="btn">Create Room</button>
      </form>
    </div>

    <div class="rooms-grid">
      <div class="card room-list">
        <div class="room-section">
          <h2>ðŸŸ¢ Active Chat Rooms</h2>
          {% for room in active_rooms %}
            <div class="room-item">
              <div class="room-info">
                <div class="room-name">{{ room.name }}</div>
                <div class="room-category">{{ room.category }}</div>
              </div>
              <a href="{% url 'peer_chat' room.id %}" class="btn btn-join">Join</a>
            </div>
          {% empty %}
            <div class="empty-state">No active chat rooms.<br>Be the first to create one!</div>
          {% endfor %}
        </div>
      </div>

      <div class="card room-list">
        <div class="room-section">
          <h2>ðŸ“š Completed Chat Rooms</h2>
          {% for room in completed_rooms %}
            <div class="room-item">
              <div class="room-info">
                <div class="room-name">{{ room.name }}</div>
                <div class="room-category">{{ room.category }}</div>
              </div>
              <a href="{% url 'peer_chat_history' room.id %}" class="btn btn-view">View History</a>
            </div>
          {% empty %}
            <div class="empty-state">No completed chat rooms yet.</div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</body>
</html>